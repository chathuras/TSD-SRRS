{"version":3,"sources":["csrf.js","resource.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"resource.js","sourcesContent":["$(document).ready(function () {\n  $.ajaxSetup({\n    headers: {\n      'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n    }\n  });\n});","$(document).ready(function () {\n  var getResources = function () {\n    $.get('/resource', function (response) {\n\n      if (response) {\n        destroyDataTable();\n        $('#iTbodyResources').html(response);\n        initializeDataTable();\n      }\n\n      $('.cBtnEdit').click(function () {\n        var id = $(this).data('id');\n\n        $.get('/resource/' + id + '/edit', function (response) {\n          $('#iDivResourceForm').html(response);\n          bindUpdateSubmit(id);\n          bindCategorySelect();\n        });\n      });\n\n      $('.cBtnDelete').click(function () {\n          var id = $(this).data('id');\n          bootbox.confirm('Are you sure?', function (result) {\n          if (result) {\n            $.get('/resource/' + id + '/delete', function (response) {\n                if (response) {\n                    $('#iDivSuccess').show('fast');\n                    setTimeout(function () {\n                        $('#iDivSuccess').hide('slow');\n                    }, 2000);\n                    getResources();\n                    $('#iFormCategory')[0].reset();\n                } else {\n                    $('#iDivError').show('fast');\n                    setTimeout(function () {\n                        $('#iDivError').hide('slow');\n                    }, 2000);\n                }\n            }).fail(function () {\n                $('#iDivError').show('fast');\n                setTimeout(function () {\n                    $('#iDivError').hide('slow');\n                }, 2000);\n            });\n          }});\n      });\n\n    });\n  };\n\n    var bindBtnIconUpload = function () {\n        $('#iBtnUpload').click(function () {\n            $('#iInputIconFile').click();\n        });\n    };\n\n  var bindStoreSubmit = function () {\n    $('#iFormResource').submit(function (event) {\n      // TODO add $.blockui\n      event.preventDefault();\n      if ($('#iFormResource').valid()) {\n        var resource = {\n            name: $('#iInputName').val(),\n            category_id: $('#iInputCategoryId').val(),\n            location: $('#iInputLocation').val(),\n            description: $('#iInputDescription').val(),\n            icon: $('#iInputIcon').val()\n        };\n\n        $.post(\"/resource\", resource, function (response) {\n\n            if (response) {\n                $('#iDivSuccess').show('fast');\n                setTimeout(function () {\n                    $('#iDivSuccess').hide('slow');\n                }, 2000);\n                getResources();\n                $('#iFormResource')[0].reset();\n            } else {\n                $('#iDivError').show('fast');\n                setTimeout(function () {\n                    $('#iDivError').hide('slow');\n                }, 2000);\n            }\n        }).fail(function () {\n            $('#iDivError').show('fast');\n            setTimeout(function () {\n                $('#iDivError').hide('slow');\n            }, 2000);\n        });\n      }\n    });\n  };\n\n  var bindUpdateSubmit = function (id) {\n    $('#iFormResource').submit(function (event) {\n      // TODO add $.blockui\n      event.preventDefault();\n\n      if ($('#iFormResource').valid()) {\n          var resource = {\n              id: id,\n              name: $('#iInputName').val(),\n              category_id: $('#iInputCategoryId').val(),\n              location: $('#iInputLocation').val(),\n              description: $('#iInputDescription').val()\n          };\n          $.ajax({\n              url: '/resource/' + id, type: 'PUT', data: resource, success: function (response) {\n\n                  if (response) {\n                      $('#iDivSuccess').show('fast');\n                      setTimeout(function () {\n                          $('#iDivSuccess').hide('slow');\n                      }, 2000);\n                      getResources();\n                      $('#iFormCategory')[0].reset();\n                  } else {\n                      $('#iDivError').show('fast');\n                      setTimeout(function () {\n                          $('#iDivError').hide('slow');\n                      }, 2000);\n                  }\n\n              }\n          }).fail(function () {\n              $('#iDivError').show('fast');\n              setTimeout(function () {\n                  $('#iDivError').hide('slow');\n              }, 2000);\n          });\n\n      }\n      console.log(resource);\n\n\n    });\n  };\n\n  var dataTable = $('.data-table');\n\n  var initializeDataTable = function () {\n    dataTable.dataTable({\n      \"bJQueryUI\": true,\n      \"sPaginationType\": \"full_numbers\",\n      \"sDom\": '<\"\"l>t<\"F\"fp>'\n    });\n  };\n\n  var destroyDataTable = function () {\n    dataTable.dataTable().fnDestroy();\n  };\n\n  var bindCategorySelect = function () {\n    $('#iSelectCategory').change(function () {\n      var categoryId = $(this).find('option:selected').val();\n      $('#iInputCategoryId').val(categoryId);\n    });\n  };\n\n    var bindInputIconFile = function () {\n        $('#iInputIconFile').on('change', function () {\n            $.ajax({\n                url: \"/resource/upload\",\n                data: new FormData($('#iFormResource')[0]),\n                dataType: 'json',\n                async: true,\n                type: 'POST',\n                processData: false,\n                contentType: false,\n                success: function (response) {\n                    $('#iInputIconFileName').val($('#iInputIconFile')[0].files[0].name);\n                    $('#iInputIcon').val(response);\n                    $('#imgIcon').attr('src', '/storage/category/' + response);\n                }\n            });\n        });\n    };\n\n  getResources();\n  bindStoreSubmit();\n  bindCategorySelect();\n  bindBtnIconUpload();\n  bindInputIconFile();\n  initializeDataTable();\n});"]}