$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})}),$(document).ready(function(){var e=function(e,t){$.get("/reservation/resources/reservations/"+t,function(n){if(n){$("#resCalendar").html(n),$("#btnCancelRes").click(function(){$("#resCalendar").attr("class","modal fade"),$("#resCalendar").attr("aria-hidden","true"),$("#resCalendar").empty()}),$("#btnResDelete").click(function(){Res=confirm("Are you sure you want to delete the selected reservation ? "),$.ajax({url:"/reservation/reservations/"+t,type:"DELETE",success:function(e){e?(a(),alert("Reservation successfully delete !"),$("#resCalendar").attr("class","modal fade"),$("#resCalendar").attr("aria-hidden","true"),$("#resCalendar").empty()):alert("delete failed. Pls try again later")}})}),$("#resSave").click(function(){if($("#iFormReservation").valid()){var n={resource_id:e,purpose:$("#iInputPurpose").val(),name:$("#iInputName").val(),address:$("#iInputAddress").val(),nic:$("#iInputNIC").val(),contact_number:$("#iInputContactNum").val(),email_address:$("#iInputEmail").val(),start:$("#iInputStartDate").data("timestamp"),end:$("#iInputEndDate").data("timestamp")};$.ajax({url:"/reservation/reservations/"+t,type:"PUT",data:n,success:function(e){e?(a(),$("#resCalendar").attr("class","modal fade"),$("#resCalendar").attr("aria-hidden","true"),$("#resCalendar").empty()):alert("Update failed. Pls try again later")}})}event.preventDefault()});var r=new Date;r.getDate(),r.getMonth(),r.getFullYear();$("#calendar").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay,listWeek"},editable:!0,selectable:!0,selectOverlap:!1,select:function(e,a,t){var n=moment(e),r=moment();n<r?$("#calendar").fullCalendar("unselect"):($("#iInputStartDate").data("timestamp",new Date(e).getTime()/1e3),$("#iInputEndDate").data("timestamp",new Date(a).getTime()/1e3))},eventResize:function(e){return!1},eventDrop:function(e){return!1},eventConstraint:{start:moment().format("YYYY-MM-DD"),end:"2100-01-01"},events:"/reservation/reservation_search?resource_id="+e+"&reservation_id="+t})}}),$("#resCalendar").attr("class","modal fade in"),$("#resCalendar").attr("aria-hidden","false")},a=function(){$.get("/reservation/index",function(a){a&&(r(),$("#iTbodyReservations").html(a),n()),$(".btnViewReservation").click(function(){var a=$(this).data("resource_id"),t=$(this).data("reservation_id");e(a,t)})})},t=$(".data-table"),n=function(){t.dataTable({bJQueryUI:!0,sPaginationType:"full_numbers",sDom:'<""l>t<"F"fp>'})},r=function(){t.dataTable().fnDestroy()};a(),n()});