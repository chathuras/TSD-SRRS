{"version":3,"sources":["csrf.js","reservation.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"reservation.js","sourcesContent":["$(document).ready(function () {\r\n  $.ajaxSetup({\r\n    headers: {\r\n      'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n    }\r\n  });\r\n});","$(document).ready(function () {\r\n  var getResources = function () {\r\n    //console.log(document.forms[0].elements['category_id'].value)\r\n    //var categoryId = document.forms[0].elements['category_id'].value;\r\n    $.get('/reservation/resources/category_id/' + document.forms[0].elements['category_id'].value, function (response) {\r\n        if (response) {\r\n            destroyDataTable();\r\n            $('#iTbodyResources').html(response);\r\n            initializeDataTable();\r\n        }\r\n        $('#btnViewResource').click(function () {\r\n            var id = $(this).data('id');\r\n            console.log('RES ID ' + id);\r\n            showResourceDialog(id);\r\n        });\r\n        $('#btnReserveResource').click(function () {\r\n            var id = $(this).data('id');\r\n            console.log('RES ID ' + id);\r\n            showReservationDialog(id);\r\n        });\r\n    });\r\n  };\r\n  var bindStoreSubmit = function () {\r\n    console.log('SUBMIT EVENT');\r\n    //$('#iFormReservation').submit(function (event) {\r\n    //document.iFormReservation.iInputNIC\r\n    //var Nic = document.getElementById(\"iFormReservation\").iInputNIC;\r\n    console.log('SUBMIT EVENT>> ' + $('#iInputName').val());\r\n    $('#iListResource').submit(function (event) {\r\n      console.log('SUBMIT EVENT IN >>');\r\n      // TODO add $.blockui\r\n      event.preventDefault();\r\n      /*  var resource = {\r\n       name: $('#iInputName').val(),\r\n       category_id: $('#iInputCategoryId').val(),\r\n       location: $('#iInputLocation').val(),\r\n       description: $('#iInputDescription').val()\r\n       }; */\r\n\r\n      //  $.post(\"/reservation\", resource, function (response) {\r\n      //    getResources();\r\n      //  });\r\n    });\r\n  };\r\n\r\n  var bindUpdateSubmit = function (id) {\r\n    console.log('UPDATE SUBMIT EVENT');\r\n    $('#iFormResource').submit(function (event) {\r\n      // TODO add $.blockui\r\n      event.preventDefault();\r\n      var resource = {\r\n        _method: 'PUT', id: id, name: $('#iInputName').val(), category_id: $('#iInputCategoryId').val(),\r\n        location: $('#iInputLocation').val(),\r\n        description: $('#iInputDescription').val()\r\n      };\r\n\r\n      console.log(resource);\r\n\r\n      $.ajax({\r\n        url: '/reservation/' + id, type: 'PUT', data: resource, success: function (response) {\r\n          getResources();\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  var dataTable = $('.data-table');\r\n\r\n  var initializeDataTable = function () {\r\n    dataTable.dataTable({\r\n      \"bJQueryUI\": true,\r\n      \"sPaginationType\": \"full_numbers\",\r\n      \"sDom\": '<\"\"l>t<\"F\"fp>'\r\n    });\r\n  };\r\n\r\n  var destroyDataTable = function () {\r\n    dataTable.dataTable().fnDestroy();\r\n  };\r\n\r\n  var bindCategorySelect = function () {\r\n    $('#iSelectCategory').change(function () {\r\n      var categoryId = $(this).find('option:selected').val();\r\n      $('#iInputCategoryId').val(categoryId);\r\n    });\r\n  };\r\n\r\n  getResources();\r\n  bindStoreSubmit();\r\n  bindCategorySelect();\r\n  initializeDataTable();\r\n\r\n  var showResourceDialog = function (resourceId) {\r\n      console.log('view resourceId >> ' + resourceId);\r\n      $.get('/reservation/resources/resource/'+ resourceId, function (response) {\r\n          // alert(response);\r\n          $('#resCalendar').html(response);\r\n\r\n          $('#resCalendar').attr(\"class\", \"modal fade in\");\r\n          $('#resCalendar').attr(\"aria-hidden\", \"false\");\r\n\r\n          $( \"#btnReserveResourceDialog\" ).click(function() {\r\n              var id = $(this).data('id');\r\n              $('#resCalendar').attr(\"class\", \"modal fade\");\r\n              $('#resCalendar').attr(\"aria-hidden\", \"true\");\r\n              showReservationDialog(id);\r\n          });\r\n\r\n          $( \"#btnCancelResourceDialog\" ).click(function() {\r\n              $('#resCalendar').attr(\"class\", \"modal fade\");\r\n              $('#resCalendar').attr(\"aria-hidden\", \"true\");\r\n              $('#resCalendar').empty();\r\n          });\r\n          event.preventDefault();\r\n      });\r\n  }\r\n\r\n  var showReservationDialog = function (resourceId) {\r\n    console.log('resourceId >> 0' + resourceId);\r\n      $.get('/reservation/resources/calendar/'+ resourceId, function (response) {\r\n\r\n          if (response) {\r\n              $('#resCalendar').html(response);\r\n\r\n              $( \"#btnCancelRes\" ).click(function() {\r\n                  $('#resCalendar').attr(\"class\", \"modal fade\");\r\n                  $('#resCalendar').attr(\"aria-hidden\", \"true\");\r\n                  $('#resCalendar').empty();\r\n              });\r\n\r\n              $( \"#resSave\" ).click(function() {\r\n                  // alert( \"Handler for .click() called.\" + $('#iInputName').val());\r\n\r\n                  // console.log($('#iInputStartDate').data('timestamp'));\r\n                  // console.log($('#iInputEndDate').data('timestamp'));\r\n\r\n                  var reservation = {\r\n                      resource_id: resourceId,\r\n                      purpose: $('#iInputPurpose').val(),\r\n                      name: $('#iInputName').val(),\r\n                      address: $('#iInputAddress').val(),\r\n                      nic: $('#iInputNIC').val(),\r\n                      contact_number: $('#iInputContactNum').val(),\r\n                      email_address: $('#iInputEmail').val(),\r\n                      start:$('#iInputStartDate').data('timestamp'),\r\n                      end:$('#iInputEndDate').data('timestamp'),\r\n                  };\r\n\r\n                  // console.log(reservation);\r\n\r\n                  // alert( \"Handler for .click() called.\" + reservation);\r\n                  $.post(\"/reservation\", reservation, function (response) {\r\n                      if (response) {\r\n                        alert(response);\r\n                      }\r\n                      $('#resCalendar').attr(\"class\", \"modal fade\");\r\n                      $('#resCalendar').attr(\"aria-hidden\", \"true\");\r\n                      $('#resCalendar').empty();\r\n                  });\r\n                  event.preventDefault();\r\n              });\r\n\r\n\r\n              $('#iInputStartDate').datepicker();\r\n              $('#iInputEndDate').datepicker();\r\n\r\n              var date = new Date();\r\n              var d = date.getDate();\r\n              var m = date.getMonth();\r\n              var y = date.getFullYear();\r\n\r\n              $('#calendar').fullCalendar({\r\n                  header: {\r\n                      left: 'prev,next today',\r\n                      center: 'title',\r\n                      right: 'month,agendaWeek,agendaDay,listWeek'\r\n                  },\r\n                  editable: true,\r\n                  selectable: true,\r\n                  selectOverlap: false,\r\n                  select: function(start, end, allDay) {\r\n                      $('#iInputStartDate').val(start);\r\n                      $('#iInputEndDate').val(start);\r\n\r\n                      // console.log(new Date(start).getTime());\r\n                      // console.log(new Date(end).getTime());\r\n\r\n                      $('#iInputStartDate').data('timestamp', new Date(start).getTime()/1000);\r\n                      $('#iInputEndDate').data('timestamp', new Date(end).getTime()/1000);\r\n                      // alert('START >> ' + new Date(start));\r\n                      /* $('#eventStart').datepicker(\"setDate\", new Date(start));\r\n                       $('#eventEnd').datepicker(\"setDate\", new Date(end));\r\n                       $('#calEventDialog') -->.dialog('open'); */\r\n                  },\r\n                  events:'/reservation/reservation_search?resource_id='+resourceId\r\n              });\r\n          }\r\n      });\r\n    //$('#resCalendar').html(calendarContent);\r\n    $('#resCalendar').attr(\"class\", \"modal fade in\");\r\n    $('#resCalendar').attr(\"aria-hidden\", \"false\");\r\n  };\r\n});\r\n"]}