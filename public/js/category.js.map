{"version":3,"sources":["csrf.js","category.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"category.js","sourcesContent":["$(document).ready(function () {\n  $.ajaxSetup({\n    headers: {\n      'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n    }\n  });\n});","$(document).ready(function () {\n  var getCategories = function () {\n    $.get('/category', function (response) {\n      if (response) {\n        destroyDataTable();\n        $('#iTbodyCategories').html(response);\n        initializeDataTable();\n      }\n\n      $('.cTrCategory').click(function () {\n        var id = $(this).data('id');\n\n        $.get('/category/' + id + '/edit', function (response) {\n          $('#iDivCategoryForm').html(response);\n          bindUpdateFormSubmit(id);\n        });\n      });\n    });\n  };\n\n  var bindStoreSubmit = function () {\n    $('#iFormCategory').submit(function (event) {\n      event.preventDefault();\n      // TODO add $.blockui\n      if ($('#iFormCategory').valid()) {\n        var category = {\n          name: $('#iInputName').val(),\n          description: $('#iTextDescription').val(),\n          icon: $('#iInputIcon').val()\n        };\n\n        $.post(\"/category\", category, function (response) {\n          if (response) {\n            $('#iDivSuccess').show('fast');\n            setTimeout(function () {\n              $('#iDivSuccess').hide('slow');\n            }, 1000);\n            getCategories();\n            $('#iFormCategory')[0].reset();\n          } else {\n            $('#iDivError').show('fast');\n            setTimeout(function () {\n              $('#iDivError').hide('slow');\n            }, 2000);\n          }\n        }).fail(function () {\n          $('#iDivError').show('fast');\n          setTimeout(function () {\n            $('#iDivError').hide('slow');\n          }, 2000);\n        });\n      }\n    });\n  };\n\n  var bindBtnIconUpload = function () {\n    $('#iBtnUpload').click(function () {\n      $('#iInputIconFile').click();\n    });\n  };\n\n  var bindUpdateFormSubmit = function (id) {\n    $('#iFormCategory').submit(function (event) {\n      // TODO add $.blockui\n      event.preventDefault();\n\n      var category = {\n        _method: 'PUT',\n        id: id,\n        name: $('#iInputName').val(),\n        description: $('#iTextDescription').val()\n      };\n\n      $.ajax({\n        url: '/category/' + id, type: 'PUT', data: category, success: function () {\n          getCategories();\n        }\n      });\n    });\n  };\n\n  var dataTable = $('.data-table');\n\n  var initializeDataTable = function () {\n    dataTable.dataTable({\n      \"bJQueryUI\": true,\n      \"sPaginationType\": \"full_numbers\",\n      \"sDom\": '<\"\"l>t<\"F\"fp>'\n    });\n  };\n\n  var destroyDataTable = function () {\n    dataTable.dataTable().fnDestroy();\n  };\n\n  var bindInputIconFile = function () {\n    $('#iInputIconFile').on('change', function () {\n      $.ajax({\n        url: \"/category/upload\",\n        data: new FormData($('#iFormCategory')[0]),\n        dataType: 'json',\n        async: true,\n        type: 'POST',\n        processData: false,\n        contentType: false,\n        success: function (response) {\n          $('#iInputIconFileName').val($('#iInputIconFile')[0].files[0].name);\n          $('#iInputIcon').val(response);\n          $('#imgIcon').attr('src', '/storage/category/' + response);\n        }\n      });\n    });\n  };\n\n  getCategories();\n  bindStoreSubmit();\n  bindBtnIconUpload();\n  bindInputIconFile();\n  initializeDataTable();\n});"]}